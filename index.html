<!DOCTYPE html>
<html>
    <head>
        <title>OMR-Korean</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,900;1,900&display=swap" rel="stylesheet">
        <style>
            body{-webkit-user-select: none; -moz-user-select: none; -ms-use-select: none; user-select: none;}
            
            #Problem{
                position: absolute;
                width: 80%;
                height: 80%;
                top: 45%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .Line{position: absolute; width: 100%; height: 10%;}
            #L1{top: 0%;}
            #L2{top: 10%;}
            #L3{top: 20%;}
            #L4{top: 30%;}
            #L5{top: 40%;}
            #L6{top: 50%;}
            #L7{top: 60%;}
            #L8{top: 70%;}
            #L9{top: 80%;}
            #L10{top: 100%;}
            #L11{top: 110%}

            .Keypad, .AKeypad{
                position: absolute;
                width: 50px;
                height: 50px;
                top: 50%;
                transform: translate(-50%, -50%);
                border: 5px solid rgb(200, 200, 200);
                color: black;
                font-size: 30px;
                font-weight: bold;
                display: flex;
                justify-content: center;
                align-items: center;
                font-family: "Roboto", sans-serif;
                font-optical-sizing: auto;
                font-weight: 900;
                font-style: normal;
                font-variation-settings: "wdth" 100;
                transition-duration: 0.5s;
            }

            .AKeypad{transition-duration: 0.4s;}
            .AKeypad:active{transition-duration: 0.1s; border: 5px solid rgb(0, 0, 0);}

            .R1{left: 10%;}
            .R2{left: 30%;}
            .R3{left: 50%;}
            .R4{left: 70%;}
            .R5{left: 90%;}
            .R6, .R45{
                position: absolute;
                height: 10px;
                top: 80%;
                left: 99.6%;
                transform: translate(-50%, -50%);
                border: 3px solid rgb(200, 200, 200);
            }
            .R45{left: 79.6%;}

            #Cancel{
                position: absolute;
                left: 100%;
                opacity: 0;
            }

            #N{
                position: absolute;
                top: 81%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-family: "Roboto", sans-serif;
                font-optical-sizing: auto;
                font-weight: 900;
                font-style: normal;
                font-variation-settings: "wdth" 100;
                white-space: pre-line;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div id="Problem">
            <div class="Line" id="L1">
                <div class="Keypad R1" id="1" onclick="Click(1)">-</div>
                <div class="Keypad R2" id="2" onclick="Click(2)">-</div>
                <div class="Keypad R3" id="3" onclick="Click(3)">-</div>
                <div class="Keypad R4" id="4" onclick="Click(4)">-</div>
                <div class="Keypad R5" id="5" onclick="Click(5)">-</div>
            </div>
            <div class="Line" id="L2">
                <div class="Keypad R1" id="6" onclick="Click(6)">-</div>
                <div class="Keypad R2" id="7" onclick="Click(7)">-</div>
                <div class="Keypad R3" id="8" onclick="Click(8)">-</div>
                <div class="Keypad R4" id="9" onclick="Click(9)">-</div>
                <div class="Keypad R5" id="10" onclick="Click(10)">-</div>
                <div class="R6 E" id="E10"></div>
            </div>
            <div class="Line" id="L3">
                <div class="Keypad R1" id="11" onclick="Click(11)">-</div>
                <div class="Keypad R2" id="12" onclick="Click(12)">-</div>
                <div class="Keypad R3" id="13" onclick="Click(13)">-</div>
                <div class="Keypad R4" id="14" onclick="Click(14)">-</div>
                <div class="Keypad R5" id="15" onclick="Click(15)">-</div>
            </div>
            <div class="Line" id="L4">
                <div class="Keypad R1" id="16" onclick="Click(16)">-</div>
                <div class="Keypad R2" id="17" onclick="Click(17)">-</div>
                <div class="Keypad R3" id="18" onclick="Click(18)">-</div>
                <div class="Keypad R4" id="19" onclick="Click(19)">-</div>
                <div class="Keypad R5" id="20" onclick="Click(20)">-</div>
                <div class="R6 E" id="E20"></div>
            </div>
            <div class="Line" id="L5">
                <div class="Keypad R1" id="21" onclick="Click(21)">-</div>
                <div class="Keypad R2" id="22" onclick="Click(22)">-</div>
                <div class="Keypad R3" id="23" onclick="Click(23)">-</div>
                <div class="Keypad R4" id="24" onclick="Click(24)">-</div>
                <div class="Keypad R5" id="25" onclick="Click(25)">-</div>
            </div>
            <div class="Line" id="L6">
                <div class="Keypad R1" id="26" onclick="Click(26)">-</div>
                <div class="Keypad R2" id="27" onclick="Click(27)">-</div>
                <div class="Keypad R3" id="28" onclick="Click(28)">-</div>
                <div class="Keypad R4" id="29" onclick="Click(29)">-</div>
                <div class="Keypad R5" id="30" onclick="Click(30)">-</div>
                <div class="R6 E" id="E30"></div>
            </div>
            <div class="Line" id="L7">
                <div class="Keypad R1" id="31" onclick="Click(31)">-</div>
                <div class="Keypad R2" id="32" onclick="Click(32)">-</div>
                <div class="Keypad R3" id="33" onclick="Click(33)">-</div>
                <div class="Keypad R4" id="34" onclick="Click(34)">-</div>
                <div class="R45 E"></div>
                <div class="Keypad R5" id="35" onclick="Click(35)">-</div>
            </div>
            <div class="Line" id="L8">
                <div class="Keypad R1" id="36" onclick="Click(36)">-</div>
                <div class="Keypad R2" id="37" onclick="Click(37)">-</div>
                <div class="Keypad R3" id="38" onclick="Click(38)">-</div>
                <div class="Keypad R4" id="39" onclick="Click(39)">-</div>
                <div class="Keypad R5" id="40" onclick="Click(40)">-</div>
                <div class="R6 E" id="E40"></div>
            </div>
            <div class="Line" id="L9">
                <div class="Keypad R1" id="41" onclick="Click(41)">-</div>
                <div class="Keypad R2" id="42" onclick="Click(42)">-</div>
                <div class="Keypad R3" id="43" onclick="Click(43)">-</div>
                <div class="Keypad R4" id="44" onclick="Click(44)">-</div>
                <div class="Keypad R5" id="45" onclick="Click(45)">-</div>
            </div>
            <div class="Line" id="L10">
                <div class="AKeypad R1" id="A1" onclick="Answer(1)">1</div>
                <div class="AKeypad R2" id="A2" onclick="Answer(2)">2</div>
                <div class="AKeypad R3" id="A3" onclick="Answer(3)">3</div>
                <div class="AKeypad R4" id="A4" onclick="Answer(4)">4</div>
                <div class="AKeypad R5" id="A5" onclick="Answer(5)">5</div>
                <div class="AKeypad" id="Cancel" onclick="Cancel()">-</div>
            </div>
        </div>
        <div id="N"></div>
        
        <script type="text/javascript">
            var Hidden = ['0', '0', '0', '0', '0', '0']
            var Ready = []
            var Correct = []
            var SplitList = []
            var Start = 1
            var Give = false

            function Click(Num){
                if(Give == false){
                    if (Ready[0] == Num){
                        document.getElementById(Num).style.borderColor = "rgb(200, 200, 200)"
                        Ready.pop()
                    }else{
                        if (Ready.length != 0){document.getElementById(Ready[0]).style.borderColor = "rgb(200, 200, 200)"}
                        document.getElementById(Num).style.borderColor = "black"
                        Ready.pop()
                        Ready.push(Num)
                    }
                }else{
                    document.getElementById(Num).style.borderColor = "rgb(151, 193, 169)"
                    document.getElementById(Num).textContent = Correct[Num-1]
                }
            }

            function Answer(Num){
                if (Ready.length > 0){
                    document.getElementById(Ready[0]).textContent=Num
                    document.getElementById(Ready[0]).style.borderColor = "rgb(200, 200, 200)"
                    if (Ready[0] < 45){
                        Ready.push(Ready[0] + 1)
                        document.getElementById(Ready[1]).style.borderColor = "black"
                    }
                }
                Ready.shift()
                Hidden.push(String(Num))
                Hidden.shift()
                HiddenCode = Hidden[0] + Hidden[1] + Hidden[2] + Hidden[3] + Hidden[4] + Hidden[5]
                if (HiddenCode == '111111'){openFile(); Hidden = ['0', '0', '0', '0', '0', '0']}
                if (HiddenCode == '222222'){Score(); Hidden = ['0', '0', '0', '0', '0', '0']}
                if (HiddenCode == '333333'){PartScore(); Hidden = ['0', '0', '0', '0', '0', '0']}
                if (HiddenCode == '444444'){Give=!Give; Hidden = ['0', '0', '0', '0', '0', '0']}
                if (HiddenCode == '555555'){Save(); Hidden = ['0', '0', '0', '0', '0', '0']}
            }

            function Cancel(){
                if (Ready.length > 0){
                    document.getElementById(Ready[0]).textContent='-'
                    document.getElementById(Ready[0]).style.borderColor = "rgb(200, 200, 200)"
                }
                Ready.shift()
                Hidden = ['0', '0', '0', '0', '0', '0']
            }

            function openFile() {
                var input = document.createElement("input");
                input.type = "file";
                input.accept = "text/plain";
                input.onchange = function (event) {
                    processFile(event.target.files[0]);
                };
                input.click();}
            function processFile(file) {
                var reader = new FileReader();
                reader.readAsText(file, "utf-8");
                reader.onload = function () {
                    Correct = reader.result.replace(/\r\n/g, ',').split(',').slice(0, 45)
                    SplitList = reader.result.replace(/\r\n/g, ',').split(',').slice(45).map(Number)
                    for (i=0; i<document.getElementsByClassName('E').length; i++){document.getElementsByClassName('E').item(i).style.borderColor = "black"}
                };
            }

            function Score(){
                for (i=0; i<45; i++){
                    if(document.getElementById(i+1).textContent != '-'){
                        if(document.getElementById(i+1).textContent == Correct[i]){document.getElementById(i+1).style.borderColor = "rgb(151, 193, 169)"}
                        else{document.getElementById(i+1).style.borderColor = "rgb(255, 150, 138)"}
                    }
                }
            }
            
            function PartScore(){
                Start = 1
                Split = ''
                for (k=0; k<10; k++){
                    N = 0
                    for (i=Start; i<Start+SplitList[k]; i++){
                        if (document.getElementById(i).textContent != "-" && document.getElementById(i).textContent != Correct[i-1]){N += 1}
                    }
                    Split += N
                    Start += SplitList[k]
                }
                document.getElementById('N').textContent = Split[0]+' / '+Split[1]+' / '+Split[2]+' / '+Split[3]+'\n'+Split[4]+' / '+Split[5]+' / '+Split[6]+' / '+Split[7]+'\n'+Split[8]+' / '+Split[9]
            }

            function Save(){
                if (document.getElementById('1').textContent == '-'){
                    OMRCallList = window.localStorage.getItem('OMR')
                    for (i=0; i<45; i++){document.getElementById(i+1).textContent = OMRCallList[i]}
                    for (i=0; i<45; i++){document.getElementById(i+1).style.borderColor = "rgb(200, 200, 200)"}
                }else{
                    OMRList = ''
                    for (i=0; i<45; i++){OMRList += document.getElementById(i+1).textContent}
                    window.localStorage.setItem('OMR', OMRList)
                }
            }
        </script>
    </body>
</html>
